{"version":3,"sources":["gchart_renderers.coffee","gchart_renderers.min.js"],"names":["callWithJQuery","openImageUrl","pivotModule","exports","module","require","define","amd","jQuery","url","iframe","x","window","open","document","write","close","$","makeGoogleChart","rendererTrans","chartType","extraOptions","pivotData","opts","agg","base","chartHolder","colKey","colKeys","commonTextStyle","dataArray","dataTable","defaults","dh","fullAggName","groupByTitle","h","hAxisTitle","headers","i","imageLink","j","k","len","len1","len2","len3","maxCharsInLegend","numCharsInHAxis","options","ref","result","row","rowKey","rowKeys","title","tree2","vAxisTitle","val","wrapper","y","localeStrings","vs","by","and","openAsImage","gchart","extend","width","innerWidth","getRowKeys","length","push","getColKeys","pivotUtilities","locales","lang","aggregatorTrans","aggregatorName","valAttrs","join","results","getValueTranslation","unshift","tree","parseFloat","format","value","google","visualization","DataTable","getTranslation","colAttrs","dataTrans","rowAttrs","addColumn","type","role","addRows","getAggregator","isNumeric","toPrecision","toFixed","arrayToDataTable","fontSize","hAxis","slantedText","textStyle","titleTextStyle","vAxis","height","chartArea","top","tooltip","annotations","legend","minValue","position","left","css","right","append","ChartWrapper","draw","bind","getChart","getImageURI","editor","hasOwnProperty","ChartEditor","events","addListener","getChartWrapper","openDialog","console","log","gchart_renderers","Line Chart","Bar Chart","Stacked Bar Chart","isStacked","Area Chart","Scatter Chart","en","ru","call","this"],"mappings":"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","file":"gchart_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n\nopenImageUrl = (url) ->\n    iframe = \"<iframe src='\" + url + \"'  style=\\\"border:0; top:0; left:0; bottom:0; right:0; width:100%; height:100%;\\\" allowfullscreen></iframe>\"\n    x = window.open()\n    x.document.open()\n    x.document.write(iframe)\n    x.document.close()\n\ncallWithJQuery ($) ->\n\n    makeGoogleChart = (chartType, extraOptions) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n                and: \"and\"\n                openAsImage: \"As image\"\n            gchart: {}\n\n        opts = $.extend true, defaults, opts\n        opts.gchart.width ?= window.innerWidth / 1.4\n#        opts.gchart.height ?= window.innerHeight / 1.4\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n        fullAggName = $.pivotUtilities.locales[opts.lang].aggregatorTrans[pivotData.aggregatorName]\n        if pivotData.valAttrs.length\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\n        headers = ($.pivotUtilities.getValueTranslation(h, opts.localeStrings).join(\"-\") for h in rowKeys)\n        headers.unshift \"\"\n\n        numCharsInHAxis = 0\n        if chartType == \"ScatterChart\"\n            dataArray = []\n            for y, tree2 of pivotData.tree\n                for x, agg of tree2\n                     dataArray.push [\n                        parseFloat(x),\n                        parseFloat(y),\n                        fullAggName+\": \\n\"+agg.format(agg.value())\n                        ]\n            dataTable = new google.visualization.DataTable()\n            hAxisTitle = $.pivotUtilities.getTranslation(pivotData.colAttrs,opts.dataTrans).join(\"-\")\n            vAxisTitle = $.pivotUtilities.getTranslation(pivotData.rowAttrs,opts.dataTrans).join(\"-\")\n            dataTable.addColumn 'number', hAxisTitle\n            dataTable.addColumn 'number', vAxisTitle\n            dataTable.addColumn type: \"string\", role: \"tooltip\"\n            dataTable.addRows dataArray\n            title = \"\"\n        else\n            dataArray = [headers]\n            for colKey in colKeys\n                row = [ $.pivotUtilities.getValueTranslation(colKey, opts.localeStrings).join(\"-\")]\n                numCharsInHAxis += row[0].length\n                for rowKey in rowKeys\n                    agg = pivotData.getAggregator(rowKey, colKey)\n                    if agg.value()?\n                        val = agg.value()\n                        if $.isNumeric val\n                            if val < 1\n                                row.push parseFloat(val.toPrecision(3))\n                            else\n                                row.push parseFloat(val.toFixed(3))\n                        else\n                            row.push val\n                    else row.push null\n                dataArray.push row\n\n            maxCharsInLegend = 0\n            for rowKey in rowKeys\n                len = rowKey.join(\"-\").length\n                maxCharsInLegend = len if maxCharsInLegend < len\n\n            dataTable = google.visualization.arrayToDataTable(dataArray)\n\n            title = vAxisTitle = fullAggName\n            hAxisTitle = $.pivotUtilities.getTranslation(pivotData.colAttrs,opts.dataTrans).join(\"-\")\n            groupByTitle = $.pivotUtilities.getTranslation(pivotData.rowAttrs,opts.dataTrans).join(\"-\")\n            if hAxisTitle != \"\" || groupByTitle != \"\"\n                title += \" #{opts.localeStrings.by}\"\n                title += \" #{hAxisTitle}\" if hAxisTitle != \"\"\n                title += \" #{opts.localeStrings.and}\" if hAxisTitle != \"\" && groupByTitle != \"\"\n                title += \" #{groupByTitle}\" if groupByTitle != \"\"\n\n        commonTextStyle = fontSize : 13\n        \n        options = \n            title: title\n            hAxis: title: hAxisTitle,slantedText: numCharsInHAxis > 50,textStyle: commonTextStyle,titleTextStyle: commonTextStyle\n            vAxis: title: vAxisTitle,textStyle: commonTextStyle,titleTextStyle: commonTextStyle\n            height: 800\n            chartArea: {width: '80%', top: '60', height: 500}\n            tooltip: textStyle: commonTextStyle\n            titleTextStyle: fontSize: 16\n            annotations: textStyle: commonTextStyle\n            legend: textStyle: commonTextStyle\n\n        if chartType == \"ColumnChart\"\n            options.vAxis.minValue = 0\n\n        if chartType == \"ScatterChart\"\n            options.legend = position: \"none\"\n            options.chartArea = {'width': '80%', 'height': '80%'}\n\n        else if dataArray[0].length == 2 and dataArray[0][1] ==  \"\"\n            options.legend = position: \"none\"\n        \n        $.extend options, opts.gchart, extraOptions\n\n        if chartType != \"ScatterChart\"\n            options.chartArea.width = colKeys.length*40\n            options.chartArea.width = 500 if options.chartArea.width < 500\n            options.width = (options.chartArea.width+200)\n            if maxCharsInLegend>4\n                options.width += maxCharsInLegend*6\n                options.chartArea.left = 100\n\n            if rowKeys.length > 22\n                dh =  (rowKeys.length - 22)*6\n                options.height += dh\n                options.chartArea.height += dh\n\n#        if options.width < opts.gchart.width\n#            options.width = opts.gchart.width\n#            options.chartArea = width: '80%', top: '60', height: '500'\n\n        result = $(\"<div>\").css(width: \"100%\", height: \"100%\", position: 'relative')\n        chartHolder = $(\"<div></div>\").css(width: \"100%\", height: \"800px\")\n        imageLink = $(\"<div><a class=\\\"btn btn-sm btn-default\\\"><i class=\\\"far fa-image fa-fw\\\"></i> #{opts.localeStrings.openAsImage}</a></div>\").css(position: 'absolute', top:'10px', right:'10px')\n        $(result[0]).append(chartHolder,imageLink)\n        wrapper = new google.visualization.ChartWrapper {dataTable, chartType, options}\n        wrapper.draw(chartHolder[0])\n#        imageUrl = wrapper.getChart().getImageURI()\n        imageLink.bind \"click\", ->\n            openImageUrl(wrapper.getChart().getImageURI())\n\n        chartHolder.bind \"dblclick\", ->\n            if google.visualization.hasOwnProperty('ChartEditor') and google.visualization.ChartEditor == 'function'\n                editor = new google.visualization.ChartEditor()\n                google.visualization.events.addListener editor, 'ok', ->\n                    editor.getChartWrapper().draw(chartHolder[0])\n                editor.openDialog(wrapper)\n            else console.log('ChartEditor not loaded')\n        return result\n\n    $.pivotUtilities.gchart_renderers = \n        \"Line Chart\": makeGoogleChart(\"LineChart\")\n        \"Bar Chart\": makeGoogleChart(\"ColumnChart\")\n        \"Stacked Bar Chart\": makeGoogleChart(\"ColumnChart\", isStacked: true)\n        \"Area Chart\": makeGoogleChart(\"AreaChart\", isStacked: true)\n        \"Scatter Chart\": makeGoogleChart(\"ScatterChart\")\n\n    rendererTrans =\n        \"Line Chart\": \"Line Chart\"\n        \"Bar Chart\": \"Bar Chart\"\n        \"Stacked Bar Chart\": \"Stacked Bar Chart\"\n        \"Area Chart\": \"Area Chart\"\n        \"Scatter Chart\": \"Scatter Chart\"\n    $.pivotUtilities.locales.en.rendererTrans = $.extend($.pivotUtilities.locales.en.rendererTrans,rendererTrans);\n    \n    rendererTrans =\n        \"Line Chart\": \"Линейчатый график\"\n        \"Bar Chart\": \"Гистограмма\"\n        \"Stacked Bar Chart\": \"Гистограмма с накоплением\"\n        \"Area Chart\": \"Диаграммма с областями\"\n        \"Scatter Chart\": \"Точечная диаграмма\"    \n    $.pivotUtilities.locales.ru.rendererTrans = $.extend($.pivotUtilities.locales.ru.rendererTrans,rendererTrans);","(function() {\n  var callWithJQuery, openImageUrl;\n\n  callWithJQuery = function(pivotModule) {\n    if (typeof exports === \"object\" && typeof module === \"object\") {\n      return pivotModule(require(\"jquery\"));\n    } else if (typeof define === \"function\" && define.amd) {\n      return define([\"jquery\"], pivotModule);\n    } else {\n      return pivotModule(jQuery);\n    }\n  };\n\n  openImageUrl = function(url) {\n    var iframe, x;\n    iframe = \"<iframe src='\" + url + \"'  style=\\\"border:0; top:0; left:0; bottom:0; right:0; width:100%; height:100%;\\\" allowfullscreen></iframe>\";\n    x = window.open();\n    x.document.open();\n    x.document.write(iframe);\n    return x.document.close();\n  };\n\n  callWithJQuery(function($) {\n    var makeGoogleChart, rendererTrans;\n    makeGoogleChart = function(chartType, extraOptions) {\n      return function(pivotData, opts) {\n        var agg, base, chartHolder, colKey, colKeys, commonTextStyle, dataArray, dataTable, defaults, dh, fullAggName, groupByTitle, h, hAxisTitle, headers, i, imageLink, j, k, len, len1, len2, len3, maxCharsInLegend, numCharsInHAxis, options, ref, result, row, rowKey, rowKeys, title, tree2, vAxisTitle, val, wrapper, x, y;\n        defaults = {\n          localeStrings: {\n            vs: \"vs\",\n            by: \"by\",\n            and: \"and\",\n            openAsImage: \"As image\"\n          },\n          gchart: {}\n        };\n        opts = $.extend(true, defaults, opts);\n        if ((base = opts.gchart).width == null) {\n          base.width = window.innerWidth / 1.4;\n        }\n        rowKeys = pivotData.getRowKeys();\n        if (rowKeys.length === 0) {\n          rowKeys.push([]);\n        }\n        colKeys = pivotData.getColKeys();\n        if (colKeys.length === 0) {\n          colKeys.push([]);\n        }\n        fullAggName = $.pivotUtilities.locales[opts.lang].aggregatorTrans[pivotData.aggregatorName];\n        if (pivotData.valAttrs.length) {\n          fullAggName += \"(\" + (pivotData.valAttrs.join(\", \")) + \")\";\n        }\n        headers = (function() {\n          var i, len1, results;\n          results = [];\n          for (i = 0, len1 = rowKeys.length; i < len1; i++) {\n            h = rowKeys[i];\n            results.push($.pivotUtilities.getValueTranslation(h, opts.localeStrings).join(\"-\"));\n          }\n          return results;\n        })();\n        headers.unshift(\"\");\n        numCharsInHAxis = 0;\n        if (chartType === \"ScatterChart\") {\n          dataArray = [];\n          ref = pivotData.tree;\n          for (y in ref) {\n            tree2 = ref[y];\n            for (x in tree2) {\n              agg = tree2[x];\n              dataArray.push([parseFloat(x), parseFloat(y), fullAggName + \": \\n\" + agg.format(agg.value())]);\n            }\n          }\n          dataTable = new google.visualization.DataTable();\n          hAxisTitle = $.pivotUtilities.getTranslation(pivotData.colAttrs, opts.dataTrans).join(\"-\");\n          vAxisTitle = $.pivotUtilities.getTranslation(pivotData.rowAttrs, opts.dataTrans).join(\"-\");\n          dataTable.addColumn('number', hAxisTitle);\n          dataTable.addColumn('number', vAxisTitle);\n          dataTable.addColumn({\n            type: \"string\",\n            role: \"tooltip\"\n          });\n          dataTable.addRows(dataArray);\n          title = \"\";\n        } else {\n          dataArray = [headers];\n          for (i = 0, len1 = colKeys.length; i < len1; i++) {\n            colKey = colKeys[i];\n            row = [$.pivotUtilities.getValueTranslation(colKey, opts.localeStrings).join(\"-\")];\n            numCharsInHAxis += row[0].length;\n            for (j = 0, len2 = rowKeys.length; j < len2; j++) {\n              rowKey = rowKeys[j];\n              agg = pivotData.getAggregator(rowKey, colKey);\n              if (agg.value() != null) {\n                val = agg.value();\n                if ($.isNumeric(val)) {\n                  if (val < 1) {\n                    row.push(parseFloat(val.toPrecision(3)));\n                  } else {\n                    row.push(parseFloat(val.toFixed(3)));\n                  }\n                } else {\n                  row.push(val);\n                }\n              } else {\n                row.push(null);\n              }\n            }\n            dataArray.push(row);\n          }\n          maxCharsInLegend = 0;\n          for (k = 0, len3 = rowKeys.length; k < len3; k++) {\n            rowKey = rowKeys[k];\n            len = rowKey.join(\"-\").length;\n            if (maxCharsInLegend < len) {\n              maxCharsInLegend = len;\n            }\n          }\n          dataTable = google.visualization.arrayToDataTable(dataArray);\n          title = vAxisTitle = fullAggName;\n          hAxisTitle = $.pivotUtilities.getTranslation(pivotData.colAttrs, opts.dataTrans).join(\"-\");\n          groupByTitle = $.pivotUtilities.getTranslation(pivotData.rowAttrs, opts.dataTrans).join(\"-\");\n          if (hAxisTitle !== \"\" || groupByTitle !== \"\") {\n            title += \" \" + opts.localeStrings.by;\n            if (hAxisTitle !== \"\") {\n              title += \" \" + hAxisTitle;\n            }\n            if (hAxisTitle !== \"\" && groupByTitle !== \"\") {\n              title += \" \" + opts.localeStrings.and;\n            }\n            if (groupByTitle !== \"\") {\n              title += \" \" + groupByTitle;\n            }\n          }\n        }\n        commonTextStyle = {\n          fontSize: 13\n        };\n        options = {\n          title: title,\n          hAxis: {\n            title: hAxisTitle,\n            slantedText: numCharsInHAxis > 50,\n            textStyle: commonTextStyle,\n            titleTextStyle: commonTextStyle\n          },\n          vAxis: {\n            title: vAxisTitle,\n            textStyle: commonTextStyle,\n            titleTextStyle: commonTextStyle\n          },\n          height: 800,\n          chartArea: {\n            width: '80%',\n            top: '60',\n            height: 500\n          },\n          tooltip: {\n            textStyle: commonTextStyle\n          },\n          titleTextStyle: {\n            fontSize: 16\n          },\n          annotations: {\n            textStyle: commonTextStyle\n          },\n          legend: {\n            textStyle: commonTextStyle\n          }\n        };\n        if (chartType === \"ColumnChart\") {\n          options.vAxis.minValue = 0;\n        }\n        if (chartType === \"ScatterChart\") {\n          options.legend = {\n            position: \"none\"\n          };\n          options.chartArea = {\n            'width': '80%',\n            'height': '80%'\n          };\n        } else if (dataArray[0].length === 2 && dataArray[0][1] === \"\") {\n          options.legend = {\n            position: \"none\"\n          };\n        }\n        $.extend(options, opts.gchart, extraOptions);\n        if (chartType !== \"ScatterChart\") {\n          options.chartArea.width = colKeys.length * 40;\n          if (options.chartArea.width < 500) {\n            options.chartArea.width = 500;\n          }\n          options.width = options.chartArea.width + 200;\n          if (maxCharsInLegend > 4) {\n            options.width += maxCharsInLegend * 6;\n            options.chartArea.left = 100;\n          }\n          if (rowKeys.length > 22) {\n            dh = (rowKeys.length - 22) * 6;\n            options.height += dh;\n            options.chartArea.height += dh;\n          }\n        }\n        result = $(\"<div>\").css({\n          width: \"100%\",\n          height: \"100%\",\n          position: 'relative'\n        });\n        chartHolder = $(\"<div></div>\").css({\n          width: \"100%\",\n          height: \"800px\"\n        });\n        imageLink = $(\"<div><a class=\\\"btn btn-sm btn-default\\\"><i class=\\\"far fa-image fa-fw\\\"></i> \" + opts.localeStrings.openAsImage + \"</a></div>\").css({\n          position: 'absolute',\n          top: '10px',\n          right: '10px'\n        });\n        $(result[0]).append(chartHolder, imageLink);\n        wrapper = new google.visualization.ChartWrapper({\n          dataTable: dataTable,\n          chartType: chartType,\n          options: options\n        });\n        wrapper.draw(chartHolder[0]);\n        imageLink.bind(\"click\", function() {\n          return openImageUrl(wrapper.getChart().getImageURI());\n        });\n        chartHolder.bind(\"dblclick\", function() {\n          var editor;\n          if (google.visualization.hasOwnProperty('ChartEditor') && google.visualization.ChartEditor === 'function') {\n            editor = new google.visualization.ChartEditor();\n            google.visualization.events.addListener(editor, 'ok', function() {\n              return editor.getChartWrapper().draw(chartHolder[0]);\n            });\n            return editor.openDialog(wrapper);\n          } else {\n            return console.log('ChartEditor not loaded');\n          }\n        });\n        return result;\n      };\n    };\n    $.pivotUtilities.gchart_renderers = {\n      \"Line Chart\": makeGoogleChart(\"LineChart\"),\n      \"Bar Chart\": makeGoogleChart(\"ColumnChart\"),\n      \"Stacked Bar Chart\": makeGoogleChart(\"ColumnChart\", {\n        isStacked: true\n      }),\n      \"Area Chart\": makeGoogleChart(\"AreaChart\", {\n        isStacked: true\n      }),\n      \"Scatter Chart\": makeGoogleChart(\"ScatterChart\")\n    };\n    rendererTrans = {\n      \"Line Chart\": \"Line Chart\",\n      \"Bar Chart\": \"Bar Chart\",\n      \"Stacked Bar Chart\": \"Stacked Bar Chart\",\n      \"Area Chart\": \"Area Chart\",\n      \"Scatter Chart\": \"Scatter Chart\"\n    };\n    $.pivotUtilities.locales.en.rendererTrans = $.extend($.pivotUtilities.locales.en.rendererTrans, rendererTrans);\n    rendererTrans = {\n      \"Line Chart\": \"Линейчатый график\",\n      \"Bar Chart\": \"Гистограмма\",\n      \"Stacked Bar Chart\": \"Гистограмма с накоплением\",\n      \"Area Chart\": \"Диаграммма с областями\",\n      \"Scatter Chart\": \"Точечная диаграмма\"\n    };\n    return $.pivotUtilities.locales.ru.rendererTrans = $.extend($.pivotUtilities.locales.ru.rendererTrans, rendererTrans);\n  });\n\n}).call(this);\n\n//# sourceMappingURL=gchart_renderers.js.map\n"]}